---
import Layout from '../../layouts/Layout.astro';
import { translations } from '../../i18n';
import CaseStudyHero from '../../components/case-study/CaseStudyHero.astro';
import SectionWithTitle from '../../components/case-study/SectionWithTitle.astro';
import ChallengeSection from '../../components/case-study/ChallengeSection.astro';
import DiagnosisSection from '../../components/case-study/DiagnosisSection.astro';
import OptimizationSection from '../../components/case-study/OptimizationSection.astro';
import ResultsSection from '../../components/case-study/ResultsSection.astro';
import TakeawaySection from '../../components/case-study/TakeawaySection.astro';
import CTASection from '../../components/case-study/CTASection.astro';

const { lang } = Astro.params;
const currentLang = (lang || 'en') as 'en' | 'zh';
const currentPath = Astro.url.pathname;
const t = translations[currentLang];
const pageTitle = t.pageTitle.caseStudy;
const pageMeta = t.pageMeta.caseStudy;
const content = t.caseStudy;

const challengePoints = [
  content.challenge.point1,
  content.challenge.point2,
  content.challenge.point3,
  content.challenge.point4,
  content.challenge.point5,
];

const diagnosisItems = [
  {
    title: content.diagnosis.landingPage.title,
    description: content.diagnosis.landingPage.description,
  },
  {
    title: content.diagnosis.trust.title,
    description: content.diagnosis.trust.description,
  },
  {
    title: content.diagnosis.budget.title,
    description: content.diagnosis.budget.description,
  },
];

const optimizationItems = [
  {
    title: content.optimization.landingPage.title,
    points: [content.optimization.landingPage.point1, content.optimization.landingPage.point2],
  },
  {
    title: content.optimization.faq.title,
    description: content.optimization.faq.description,
  },
  {
    title: content.optimization.alignment.title,
    description: content.optimization.alignment.description,
  },
];

const resultsPoints = [
  content.results.point1,
  content.results.point2,
  content.results.point3,
  content.results.point4,
  content.results.point5,
];

export function getStaticPaths() {
  return [
    { params: { lang: 'en' } },
    { params: { lang: 'zh' } },
  ];
}
---

<Layout title={pageTitle} description={pageMeta.description} keywords={pageMeta.keywords} lang={currentLang} currentLang={currentLang} currentPath={currentPath}>
  <main class="min-h-screen">
    <CaseStudyHero
      title={content.title}
      industry={content.metadata.industry}
      location={content.metadata.location}
      spend={content.metadata.spend}
      type={content.metadata.type}
    />

    <SectionWithTitle title={content.background.title}>
      <p class="text-lg text-gray-700 leading-relaxed">
        {content.background.description}
      </p>
    </SectionWithTitle>

    <ChallengeSection title={content.challenge.title} points={challengePoints} />

    <DiagnosisSection
      title={content.diagnosis.title}
      description={content.diagnosis.description}
      items={diagnosisItems}
    />

    <OptimizationSection
      title={content.optimization.title}
      description={content.optimization.description}
      items={optimizationItems}
    />

    <ResultsSection title={content.results.title} points={resultsPoints} />

    <TakeawaySection
      title={content.takeaway.title}
      description={content.takeaway.description}
    />

    <CTASection
      title={content.cta.title}
      description={content.cta.description}
      buttonText={content.cta.button}
      contactLink={`/${currentLang === 'en' ? 'en' : 'zh'}/contact`}
    />
  </main>
</Layout>

<style>
  main {
    width: 100%;
  }
</style>
